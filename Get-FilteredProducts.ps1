
###########################################################################
###########################################################################
## 
## File: Get-FilteredProducts
## Name: anthony lee
## Date: 11/29/2011
## Desc. Searches an OU for computers and outputs a list of installed 
## 			Software.
##
###########################################################################
###########################################################################

########################### Change Log ####################################
##
## Modified Date:
## Mod By: 
## Changes: 
##
###########################################################################
###########################################################################

############################# Header ######################################
## DECLARE PARAMETERS, ADDINS/SNAPINS, AND GLODAL VARIABLES
##
param($SearchRoot)
Add-PSSnapin Quest.ActiveRoles.ADManagement -errorAction SilentlyContinue
###########################################################################
###########################################################################

############################# Notes #######################################
## 
###########################################################################
###########################################################################

############################# Main ########################################
##
$Computers = Get-QADComputer -SearchRoot $SearchRoot
$Creds = Get-Credential
Foreach($Computer in $Computers)
{
    $Poducts = get-wmiobject -class Win32_Product -Computer $Computer.name -Credential $Creds | where{$_.Vendor -ne "Vendor Name 1" -and $_.Vendor -ne "Vendor Name 2" -and $_.Vendor -ne "Vendor Name 3"} | format-list Name
		# replace "Vendor Name # with the name of a vendor whose software you may not want listed because it's commonly used i.e., Microsoft"
    $Products | Out-File Products.csv
}
###########################################################################
###########################################################################


###########################################################################
###########################################################################

######################### End of Script ###################################

###########################################################################
###########################################################################